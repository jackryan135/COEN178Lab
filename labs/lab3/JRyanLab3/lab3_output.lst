SQL> start queries_part1.sql

FULL_NAME                                    SALARY                             
---------------------------------------- ----------                             
 Timothy P.Love                              179700                             
 Michael M.Hash                              179700                             


LAST                     SALARY                                                 
-------------------- ----------                                                 
Simas                    100000                                                 
Teehee                   100000                                                 
Vega                     100000                                                 
Bhowmik                  100000                                                 
DuBois                   100000                                                 
Frankel                  100000                                                 
Hurwitz                  100000                                                 
Jarvis-Shean             100000                                                 
Jones                    100000                                                 
Zichal                   100000                                                 

10 rows selected.


LAST                     SALARY                                                 
-------------------- ----------                                                 
Simas                    100000                                                 
Teehee                   100000                                                 
Vega                     100000                                                 
Bhowmik                  100000                                                 
DuBois                   100000                                                 
Frankel                  100000                                                 
Hurwitz                  100000                                                 
Jarvis-Shean             100000                                                 
Jones                    100000                                                 
Zichal                   100000                                                 

10 rows selected.


LAST                     SALARY                                                 
-------------------- ----------                                                 
Metcalf                   42000                                                 
Mrazek                    42000                                                 
Northern                  42000                                                 
Ocampo                    42000                                                 
Oxtoby                    42000                                                 
Page                      42000                                                 
Pope                      42000                                                 
Portilla                  42000                                                 
Posey                     42000                                                 
Pulliam                   42000                                                 
Robertson                 42000                                                 

LAST                     SALARY                                                 
-------------------- ----------                                                 
Schaub                    42000                                                 
Schmuck                   42000                                                 
Sinha                     42000                                                 
Sirbu                     42000                                                 
Smith                     42000                                                 
Smith                     42000                                                 
Stickel                   42000                                                 
Swanson                   42000                                                 
Tennison                  42000                                                 
Thomas                    42000                                                 
Tranchin                  42000                                                 

LAST                     SALARY                                                 
-------------------- ----------                                                 
Alley                     42000                                                 
Asen                      42000                                                 
Attili                    58511                                                 
Ayling                    42000                                                 
Baggetto                  42000                                                 
Bates                     42000                                                 
Bisi                      42000                                                 
Block                     42000                                                 
Campbell                  42000                                                 
Campos                    42000                                                 
Canery                    58511                                                 

LAST                     SALARY                                                 
-------------------- ----------                                                 
Carden                    42000                                                 
Castillo                  42000                                                 
Chhabra                   42000                                                 
Claude                    58511                                                 
Cobbina                   42000                                                 
Conrad                    42000                                                 
Cuba                      42000                                                 
Cunningham                42000                                                 
Donovan                   42000                                                 
Dorsett                   42000                                                 
Faulman                   42000                                                 

LAST                     SALARY                                                 
-------------------- ----------                                                 
Fenn                      42000                                                 
Fergenson                 42000                                                 
Ford                      42000                                                 
Frank                     42000                                                 
Godfrey                   42000                                                 
Gottlieb                  42000                                                 
Grant                     42000                                                 
Hanson                    42000                                                 
Harris                    42000                                                 
Hegde                     42000                                                 
Hernandez                 42000                                                 

LAST                     SALARY                                                 
-------------------- ----------                                                 
Hiatt                     42000                                                 
Hughes                    42000                                                 
Jackson                   42000                                                 
Jones                     42000                                                 
Kennedy                   42000                                                 
Ledbetter                 42000                                                 
Lee                       42000                                                 
Lewin                     42000                                                 
Lewis                     42000                                                 
Limon                     42000                                                 
Young                     42000                                                 

LAST                     SALARY                                                 
-------------------- ----------                                                 
Young                     58511                                                 

67 rows selected.


SALARIES_100K_ABOVE                                                             
-------------------                                                             
                134                                                             


    SALARY SALARIES_100K_ABOVE                                                  
---------- -------------------                                                  
    158500                   9                                                  
    102000                   8                                                  
    155500                   5                                                  
    112774                   1                                                  
    145000                   1                                                  
    113000                   5                                                  
    136134                   1                                                  
    165000                   1                                                  
    130000                   5                                                  
    153500                   2                                                  
    162500                   1                                                  

    SALARY SALARIES_100K_ABOVE                                                  
---------- -------------------                                                  
    139500                   1                                                  
    129758                   1                                                  
    130500                  26                                                  
    114000                   3                                                  
    100904                   2                                                  
    149000                   2                                                  
    172200                  23                                                  
    147500                   4                                                  
    115731                   1                                                  
    123758                   1                                                  
    162900                   1                                                  

    SALARY SALARIES_100K_ABOVE                                                  
---------- -------------------                                                  
    172000                   1                                                  
    106839                   1                                                  
    110500                   1                                                  
    132009                   1                                                  
    122744                   1                                                  
    140259                   1                                                  
    113605                   1                                                  
    148510                   2                                                  
    126251                   1                                                  
    179700                   2                                                  
    120000                   8                                                  

    SALARY SALARIES_100K_ABOVE                                                  
---------- -------------------                                                  
    102829                   1                                                  
    110000                   1                                                  
    150000                   3                                                  
    144868                   1                                                  
    107770                   1                                                  
    140000                   2                                                  
    105211                   1                                                  

40 rows selected.


    SALARY SALARIES_100K_ABOVE                                                  
---------- -------------------                                                  
    130500                  26                                                  
    172200                  23                                                  


LAST                                                                            
--------------------                                                            
Reed                                                                            
Reeves                                                                          
Sheehy                                                                          
Smoot                                                                           
Sweeney                                                                         
Teehee                                                                          
Bookey-Baker                                                                    
Brooke                                                                          
Deese                                                                           
Freeman                                                                         
Goodman                                                                         

LAST                                                                            
--------------------                                                            
Goodman                                                                         
Green                                                                           
Green                                                                           
Greenawalt                                                                      
Greene                                                                          
Keenan                                                                          
Koo                                                                             
Lee                                                                             
Lee                                                                             
Voorman                                                                         

21 rows selected.

SQL> start tables_part2.sql

Table created.


Table created.


1 row created.


1 row created.


1 row created.


1 row created.


1 row created.


1 row created.


1 row created.


1 row created.


1 row created.


1 row created.


1 row created.

SQL> start queries_part2.sql

     EMPNO EMPNAME    DEPTI                                                     
---------- ---------- -----                                                     
         1 smith      d1                                                        
         2 jones      d2                                                        
         3 wayne      d1                                                        
         4 moor       d3                                                        
         5 king       d1                                                        
         6 chen       d1                                                        
         7 winger     d3                                                        

7 rows selected.


DEPTI DEPTNAME                                                                  
----- ----------                                                                
d1    Research                                                                  
d2    Devt                                                                      
d3    Testing                                                                   
d4    Advert                                                                    


DEPTN   EMPCOUNT                                                                
----- ----------                                                                
d3             2                                                                
d1             4                                                                
d2             1                                                                


DEPTN DEPTNAME     EMPCOUNT                                                     
----- ---------- ----------                                                     
d3    Testing             2                                                     
d1    Research            4                                                     
d2    Devt                1                                                     


DEPTN DEPTNAME     EMPCOUNT                                                     
----- ---------- ----------                                                     
d2    Devt                1                                                     
d3    Testing             2                                                     
d1    Research            4                                                     

SELECT deptid, max(count(*)) FROM L_EMP GROUP BY deptid
       *
ERROR at line 1:
ORA-00937: not a single-group group function 


SELECT deptid FROM L_EMP GROUP BY deptid HAVING count(*) = (SELECT count(*) FROM L_EMP GROUP BY deptid)
                                                            *
ERROR at line 1:
ORA-01427: single-row subquery returns more than one row 



DEPTI                                                                           
-----                                                                           
d1                                                                              


DEPTNAME                                                                        
----------                                                                      
Research                                                                        


DEPTI      EMPNO EMPNAME    DEPTNAME                                            
----- ---------- ---------- ----------                                          
d1             1 smith      Research                                            
d2             2 jones      Devt                                                
d1             3 wayne      Research                                            
d3             4 moor       Testing                                             
d1             5 king       Research                                            
d1             6 chen       Research                                            
d3             7 winger     Testing                                             

7 rows selected.


DEPTI      EMPNO EMPNAME    DEPTNAME                                            
----- ---------- ---------- ----------                                          
d1             1 smith      Research                                            
d2             2 jones      Devt                                                
d1             3 wayne      Research                                            
d3             4 moor       Testing                                             
d1             5 king       Research                                            
d1             6 chen       Research                                            
d3             7 winger     Testing                                             

7 rows selected.

SQL> spool off
